# Copyright 2020 RICOS Co. Ltd.
#
# This file is a part of ricosjp/allgebra, distributed under Apache-2.0 License
# https://github.com/ricosjp/allgebra

# This file is automatically generated by allgebra_template/gen_allgebra.sh

ARG REGISTRY
ARG TAG

FROM \${REGISTRY}/cuda${CUDA_MAJOR}_${CUDA_MINOR}:\${TAG}

RUN apt-get update && apt-get install -y \\
    gcc-${GCC_MAJOR}-offload-nvptx \\
    libelf-dev \\
    nvptx-tools \\
    && apt-get clean \\
    && rm -rf /var/lib/apt/lists/*

# Override GCC${GCC_MAJOR} by GCC
RUN rm -f /usr/bin/gcc /usr/bin/g++ \\
    && ln -s /usr/bin/gcc-${GCC_MAJOR} /usr/bin/gcc \\
    && ln -s /usr/bin/g++-${GCC_MAJOR} /usr/bin/g++

ENV ALLGEBRA_GCC_INSTALL_DIR /usr
ENV ALLGEBRA_GCC_VERSION ${GCC_MAJOR}.${GCC_MINOR}.${GCC_PATCH}
ENV ALLGEBRA_GCC_VERSION_MAJOR ${GCC_MAJOR}
ENV ALLGEBRA_GCC_VERSION_MINOR ${GCC_MINOR}
ENV ALLGEBRA_GCC_VERSION_PATCH ${GCC_PATCH}
